function ViewModel(){"use strict";var e=this;e.infowindow=new google.maps.InfoWindow;var t=new google.maps.LatLngBounds;e.yelp=function(t,i){function o(){return Math.floor(1e12*Math.random()).toString()}var n="https://api.yelp.com/v2/search",a={oauth_consumer_key:"D3T3U7PuQOiSdGA5qjMzHA",oauth_token:"oEvBSwc2vDVZx8fXMBsaBG2Gh0m81rWu",oauth_nonce:o(),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb",location:"Edinburgh",term:t,limit:1},s=oauthSignature.generate("GET",n,a,"Pr6XgjTJToauI5yxWD-NkHN8Ijk","ptGvG6G4JB-rT_20tw07f8eEoLU");a.oauth_signature=s;var r={url:n,data:a,cache:!0,dataType:"jsonp",success:function(t){void 0!==t.businesses[0]&&void 0!==t.businesses[0].snippet_text?e.infowindow.setContent('<span><img src="img/yelp.png" alt="Yelp" style="margin-bottom: 10px;"> review:</span><p>'+t.businesses[0].snippet_text+'</p><a href="'+t.businesses[0].url+'" target="_blank">Read more</a>'):e.infowindow.setContent(i)},error:function(){e.infowindow.setContent(i)}};$.ajax(r)},e.locations=ko.observableArray(locations);var i;e.locations().forEach(function(o){i=new google.maps.Marker({position:o.coordinates,map:map,icon:o.icon,description:o.description,title:o.title,animation:google.maps.Animation.DROP}),o.marker=i,t.extend(i.position),map.fitBounds(t),map.panToBounds(t),o.visibility=ko.observable(!0),i.addListener("click",function(){e.infowindow.setContent('<div style="width: 400px; height: 8px; background-color: #eaeaea;"></div><div style="margin-top: 8px; width: 300px; height: 8px; background-color: #eaeaea;"></div>'),e.yelp(this.title,this.description),map.setCenter(this.position),e.infowindow.open(map,this),this.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){o.marker.setAnimation(null)},700)})}),e.listItemClicked=function(e){google.maps.event.trigger(this.marker,"click")},e.filterInput=ko.observable(),e.locationFilter=ko.computed(function(){if(void 0!==e.filterInput()){e.infowindow.close();var t,i=e.filterInput().toLowerCase();e.locations().forEach(function(e){t=e.title.toLowerCase(),t.search(i)===-1?(e.marker.setVisible(!1),e.visibility(!1)):(e.marker.setVisible(!0),e.visibility(!0))})}},this)}function initMap(){"use strict";var e=[{featureType:"all",elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#000000"},{lightness:40}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#000000"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:17},{weight:1.2}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#000000"},{lightness:21}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#000000"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#000000"},{lightness:16}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#000000"},{lightness:19}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#000000"},{lightness:17}]}];map=new google.maps.Map(document.getElementById("map"),{styles:e,mapTypeControl:!1}),google.maps.event.addDomListener(window,"resize",function(){var e=map.getCenter();google.maps.event.trigger(map,"resize"),map.setCenter(e)}),ko.applyBindings(new ViewModel)}var locations=[{title:"Wings",icon:"img/chicken-wing.png",coordinates:{lat:55.949443,lng:-3.189398},description:"The best chicken wings in town."},{title:"Baked Potato Shop",icon:"img/potato.png",coordinates:{lat:55.950501,lng:-3.188515},description:"Delicious baked potatoes with a variety of different fillings."},{title:"Brew Dog",icon:"img/beer.png",coordinates:{lat:55.948594,lng:-3.189563},description:"Amazing craft beer."},{title:"Oink",icon:"img/yummy.png",coordinates:{lat:55.949393,lng:-3.194352},description:"Delicious pulled pork sandwiches."},{title:"Petit Paris",icon:"img/wine.png",coordinates:{lat:55.947736,lng:-3.196568},description:"Probably the best French restaurant in town."},{title:"The Devil's Advocate",icon:"img/dark-beer.png",coordinates:{lat:55.950462,lng:-3.19165},description:"Amazing selection of fine beers and whiskeys."},{title:"Harajuku Kitchen",icon:"img/sushi-box.png",coordinates:{lat:55.940836,lng:-3.203995},description:"Probably the best Japanese Restaurant in town."},{title:"Stockbridge Market",icon:"img/street-food.png",coordinates:{lat:55.957681,lng:-3.208512},description:"Farmers' market, amazing street food."},{title:"The Holyrood 9A",icon:"img/burger.png",coordinates:{lat:55.949501,lng:-3.182734},description:"Probably the best burgers in town."},{title:"Arthur's Seat",icon:"img/shoe.png",coordinates:{lat:55.944635,lng:-3.161833},description:"Climb it and enjoy a great view of the city."},{title:"Hank's",icon:"img/sandwich.png",coordinates:{lat:55.943015,lng:-3.211281},description:"Amazing sandwiches and salads."},{title:"The Oz Bar",icon:"img/8-ball.png",coordinates:{lat:55.947682,lng:-3.192091},description:"Awesome place to go for a game of pool."},{title:"The Bon Vivant",icon:"img/cocktail.png",coordinates:{lat:55.954163,lng:-3.199671},description:"Great food and drinks."},{title:"Ali Willmore Hairdressing",icon:"img/haircut.png",coordinates:{lat:55.950488,lng:-3.184093},description:"Probably the best hairdresser in town."},{title:"Skyscanner HQ",icon:"img/unicorn.png",coordinates:{lat:55.944458,lng:-3.194548},description:"Edinburgh's local unicorn, use their app to find cheap flights."},{title:"Rockstar North",icon:"img/rocket.png",coordinates:{lat:55.950382,lng:-3.176155},description:"This is where people work on the latest Grand Theft Auto game."},{title:"Lovecrumbs",icon:"img/coffee.png",coordinates:{lat:55.946127,lng:-3.201857},description:"Probably the best coffee in town."},{title:"Pinnies & Poppy Seeds",icon:"img/doughnut.png",coordinates:{lat:55.950265,lng:-3.1836},description:"Amazing shortbread, doughnuts and other treats."},{title:"Wee Bite",icon:"img/bacon.png",coordinates:{lat:55.950518,lng:-3.184185},description:"Probably the best bacon rolls in town."},{title:"La Favorita",icon:"img/pizza.png",coordinates:{lat:55.964715,lng:-3.176667},description:"Amazing pizza!"}],map;